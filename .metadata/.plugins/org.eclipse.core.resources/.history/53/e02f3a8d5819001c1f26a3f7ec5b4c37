package com.matsuura.FaceMusicBatch.controllers;

import java.util.ArrayList;

import com.matsuura.FaceMusicBatch.interfaces.GetAccessTokenListener;
import com.matsuura.FaceMusicBatch.interfaces.GetEmotionAndDurationListener;
import com.matsuura.FaceMusicBatch.interfaces.GetPlayListListener;
import com.matsuura.FaceMusicBatch.model.EmotionAndDurationDataModel;
import com.matsuura.FaceMusicBatch.service.SpotifyApiClient;

/** Age Detection用を更新するためのコントローラーです **/

public class UpdateAgeTableController implements GetAccessTokenListener, GetPlayListListener, GetEmotionAndDurationListener {

	/** 変数 **/
	private String accessToken;

	private ArrayList<String> playList;

	private int api_call_count = 0;

	/** 定数 **/

	// 各年代のプレイリスト
	private final String GENERATION_1980_PLAY_LIST = "37i9dQZF1DXdX26YqusBdd";
	private final String GENERATION_1990_PLAY_LIST = "37i9dQZF1DWWNbVDKoV50L";
	private final String GENERATION_2000_PLAY_LIST = "37i9dQZF1DX4OQAiraQRL0";
	private final String GENERATION_2010_PLAY_LIST = "66k8O1RBpVeI9B3bm90aTB";

	private final String[] idList = { GENERATION_1980_PLAY_LIST, GENERATION_1990_PLAY_LIST, GENERATION_2000_PLAY_LIST,
			GENERATION_2010_PLAY_LIST };

	/** コンストラクタ **/

	public UpdateAgeTableController() {

	}

	/** コントローラーを起動する関数です **/

	public void excute() {

		// Spotofy アクセストークンを取得します
		SpotifyApiClient.getInstance().getAccessToken(this);

	}

	/** アクセストークン取得時に実行されるコールバック関数です
	 * @param accessToken String アクセストークン
	 */
	public void onSuccess(String accessToken) {

		this.accessToken = accessToken;

		for (int i = 0; i < idList.length; i++) {

			SpotifyApiClient.getInstance().getMusicList(idList[i], accessToken);

		}

	}

	public void onSuccess() {

		api_call_count ++;

		if (api_call_count == 4) {

			SpotifyApiClient.getInstance().getEmotionAndDurationData(id, this.accessToken, listener);

		}
	}

	public void onSuccess(EmotionAndDurationDataModel data) {
		// TODO 自動生成されたメソッド・スタブ

	}

	public void onFailure(String errorCode) {

	}



}
